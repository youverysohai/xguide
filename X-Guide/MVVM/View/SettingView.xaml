<UserControl x:Class="X_Guide.MVVM.View.SettingView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:X_Guide.MVVM" 
             xmlns:valid="clr-namespace:X_Guide.Validation"
             mc:Ignorable="d"
             d:Width="900"
             xmlns:ui="http://schemas.modernwpf.com/2019"
             d:Foreground="White"
             xmlns:hc="https://handyorg.github.io/handycontrol"
             
             >

    <UserControl.Resources>
        <ControlTemplate x:Key="ValidationErrorTemplate">
            <DockPanel LastChildFill="True">
                <TextBlock DockPanel.Dock="Right" Foreground="Red" 
                   Margin="5,0,0,0" Text="*" />

                <AdornedElementPlaceholder />
                <ItemsControl ItemsSource="{Binding}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding ErrorContent}" Foreground="Red"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

            </DockPanel>
        </ControlTemplate>





    </UserControl.Resources>
    <ScrollViewer VerticalScrollBarVisibility="Hidden" >

        <materialDesign:Card Style="{DynamicResource CardLayout}">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto "/>

                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>

                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="3*"/>
                </Grid.RowDefinitions>
                 

                <!-- Machine Info -->
                <ui:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Top" Grid.Row="0" Margin="20 0">
                    <materialDesign:PackIcon  Kind="RobotIndustrialOutline" Style="{DynamicResource IconStyle24}" Margin="0 0 5 0"/>
                    <TextBlock FontSize="16" FontWeight="Light"  VerticalAlignment="Center">
                        
                          <Run Text="Manipulator" />
                    </TextBlock>
                     
                    <!--<ComboBox 
                            ItemsSource="{Binding MachineNameList}"
                            IsTextSearchEnabled="False"
                            MinWidth="220"
                            Text="{Binding MachineName}"
                            SelectedItem="{Binding MachineName}"
                            SelectedValue="{Binding MachineName}"
                            IsEditable="{Binding CanEdit}"
                            Style="{DynamicResource ComboBoxStyle}"
                        Padding="5"
                        VerticalAlignment="Top"
                        FontWeight="DemiBold"
                        
                                    materialDesign:HintAssist.Hint="Manipulator Name"  
                                    />-->
                    <StackPanel Orientation="Horizontal" Grid.Column="3" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0 10 100 0" Visibility="Visible">
                        <Button Command="{Binding EditManipulatorNameCommand}" Visibility="{Binding EditBtnVisibility}">
                            <materialDesign:PackIcon Kind="EditOutline"/>
                        </Button>
                        <Button Command="{Binding EditManipulatorNameCommand}" Visibility="{Binding SaveBtnVisibility}">
                            <materialDesign:PackIcon Kind="ContentSaveOutline"/>
                        </Button>
                        <Button Command="{Binding EditManipulatorNameCommand}" Visibility="{Binding CancelBtnVisibility}">
                            <materialDesign:PackIcon Kind="PencilOffOutline"/>
                        </Button>
                    </StackPanel>

                </ui:SimpleStackPanel>



                <!--Machine Type ComboBox-->
                <ui:SimpleStackPanel Orientation="Horizontal"  Grid.Row="1">
                    <ComboBox 
                       
                           HorizontalAlignment="Left"
                            ItemsSource="{Binding MachineTypeList}"
                            DisplayMemberPath="Description"
                            SelectedValuePath="Value"
                            SelectedItem="{Binding MachineType}"
                            SelectedValue="{Binding MachineType}"
                                    Style="{DynamicResource ComboBoxStyle}" 
                                MinWidth="150"    
                                    materialDesign:HintAssist.Hint="Type"  
                        Padding="5"
                        VerticalAlignment="Top"
                                    >

                        <!--Text="{Binding MachineID,UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=False, NotifyOnValidationError=True}"-->
                    </ComboBox>
                    <!--Machine Description TextArea (scrollable)-->
                    <TextBox
                         
                                     
                                    AcceptsReturn="True"
                                    Style="{DynamicResource MaterialDesignFloatingHintTextBox}"  
                                    materialDesign:HintAssist.Hint="Manipulator Description"
                                    VerticalAlignment="Top"
                                    HorizontalAlignment="Left"
                                    Padding="0 8 0 0"
                                    MinHeight="60"
                                    VerticalScrollBarVisibility="Visible"
                                    HorizontalScrollBarVisibility="Visible"
                                    Margin="30 0 0 0"
                                    TextWrapping="Wrap"
                                     FontSize="16"
                                    Text ="{Binding MachineDescription,UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=False, NotifyOnValidationError=True}" Width="200">
                    </TextBox>


                </ui:SimpleStackPanel>
                <Grid Grid.Row="2" Margin="0 10 0 0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto"/>
                        <ColumnDefinition Width="auto"/>
                        <ColumnDefinition Width="auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Label Grid.Column="0"  FontSize="13"  FontWeight="Light" Margin="15 5 0 0" Content="IP Address"/>
                    <Label Grid.Column="1"  FontSize="13"  FontWeight="Light" Margin="15 5 0 0" Content="Port"/>
                    <Label Grid.Column="2"  FontSize="13"  FontWeight="Light" Margin="30 5 0 0" Content="Terminator"/>
                    <ui:SimpleStackPanel Grid.Row="1" Orientation="Horizontal"  HorizontalAlignment="Stretch" Margin="10 0 15 0">
                        <TextBox x:Name="txtRobotIP1" Style="{DynamicResource IPInputMaterialDesignTextBox}" HorizontalAlignment="Center"  GotFocus="txtIP_GotFocus" TextChanged="TxtIPLength_TextChanged" PreviewKeyDown="txtIP_PreviewKeyDown" PreviewTextInput="TxtIPAddress_PreviewTextInput">
                            <Binding Path="RobotIPS1" UpdateSourceTrigger="PropertyChanged">
                            </Binding>
                        </TextBox>
                        <materialDesign:PackIcon Style="{DynamicResource IconStyle16}"  VerticalAlignment="Bottom"  Kind="CircleSmall"/>
                        <TextBox x:Name="txtRobotIP2" Style="{DynamicResource IPInputMaterialDesignTextBox}" HorizontalAlignment="Center" GotFocus="txtIP_GotFocus" TextChanged="TxtIPLength_TextChanged" PreviewTextInput="TxtIPAddress_PreviewTextInput" PreviewKeyDown="txtIP_PreviewKeyDown">
                            <Binding Path="RobotIPS2" UpdateSourceTrigger="PropertyChanged">

                            </Binding>
                        </TextBox>
                        <materialDesign:PackIcon Style="{DynamicResource IconStyle16}"  VerticalAlignment="Bottom"  Kind="CircleSmall"/>
                        <TextBox x:Name="txtRobotIP3"  Style="{DynamicResource IPInputMaterialDesignTextBox}" HorizontalAlignment="Center" GotFocus="txtIP_GotFocus" TextChanged="TxtIPLength_TextChanged" PreviewTextInput="TxtIPAddress_PreviewTextInput" PreviewKeyDown="txtIP_PreviewKeyDown"   >
                            <Binding Path="RobotIPS3" UpdateSourceTrigger="PropertyChanged">

                            </Binding>
                        </TextBox>
                        <materialDesign:PackIcon Style="{DynamicResource IconStyle16}" VerticalAlignment="Bottom" Kind="CircleSmall"/>

                        <TextBox x:Name="txtRobotIP4"  Style="{DynamicResource IPInputMaterialDesignTextBox}" HorizontalAlignment="Center" GotFocus="txtIP_GotFocus" TextChanged="TxtIPLength_TextChanged" PreviewTextInput="TxtIPAddress_PreviewTextInput" PreviewKeyDown="txtIP_PreviewKeyDown"    >
                            <Binding Path="RobotIPS4" UpdateSourceTrigger="PropertyChanged">

                            </Binding>
                        </TextBox>
                    </ui:SimpleStackPanel>
                    <TextBox  Grid.Row="1" Grid.Column="1"
                          Style="{DynamicResource InputMaterialDesignTextBox}"
                          Text="{Binding RobotPort}"
                          PreviewTextInput="TxtPort_PreviewTextInput"
                          HorizontalAlignment="Left"
                          
                           
                                       />
                    <ComboBox  Grid.Row="1" Grid.Column="2"  ItemsSource="{Binding TerminatorList}" DisplayMemberPath="Value"
                            SelectedValuePath="Description" SelectedItem="{Binding ManipulatorTerminator}" SelectedValue="{Binding ManipulatorTerminator}" 
                                          Style="{DynamicResource MaterialDesignFloatingHintComboBox}"
                                          Margin="30 0 0 0" 
                                          FontSize="15"
                                          HorizontalAlignment="Left"  
                                          Width="160"
                                          >
                    </ComboBox>

                </Grid>
                <ui:NavigationViewItemSeparator Grid.Row="4"  VerticalAlignment="Top"></ui:NavigationViewItemSeparator>


                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Grid.Row="5" Grid.ColumnSpan="3">
                    <materialDesign:PackIcon  Kind="CameraOutline" Style="{DynamicResource IconStyle24}"  Margin="20 0 5 0"/>
                    <TextBlock FontSize="16" FontWeight="Light"  VerticalAlignment="Center" HorizontalAlignment="Right">
                          <Run Text="Vision"/>
                    </TextBlock>
                    <ComboBox Style="{DynamicResource ComboBoxStyle}"   
                              Padding="5"
                            VerticalAlignment="Top"
                             
                                 IsTextSearchEnabled="False"
                            MinWidth="220"
                                  materialDesign:HintAssist.Hint="Vision Software"
                              Margin="50 0 0 0"     
                              >
                        <ComboBoxItem IsSelected="True">Vision Master</ComboBoxItem>
                    </ComboBox>

                </StackPanel>
                <StackPanel Orientation="Horizontal" Grid.Row="6" Margin="0 5">
                    <TextBox x:Name="TxtVisionSoftware" Style="{DynamicResource InputMaterialDesignTextBox}" MinWidth="300" Text="{Binding LogFilePath}"
                                    materialDesign:HintAssist.Hint="Vision Software Path (.sol)" />
                    <Button x:Name="BrowseBtn" Margin="10" Content="Browse"  Click="BrowseBtn_Click"/>

                </StackPanel>

                <Grid Grid.Row="7" Margin="0 10 0 0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto"/>
                        <ColumnDefinition Width="auto"/>
                        <ColumnDefinition Width="auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Label Grid.Column="0"  FontSize="13"  FontWeight="Light" Margin="15 5 0 0" Content="IP Address"/>
                    <Label Grid.Column="1"  FontSize="13"  FontWeight="Light" Margin="15 5 0 0" Content="Port"/>
                    <Label Grid.Column="2"  FontSize="13"  FontWeight="Light" Margin="30 5 0 0" Content="Terminator"/>
                    <ui:SimpleStackPanel Grid.Row="1" Orientation="Horizontal"  HorizontalAlignment="Stretch" Margin="10 0 15 0">
                        <TextBox x:Name="txtVisionIP1" Style="{DynamicResource IPInputMaterialDesignTextBox}" HorizontalAlignment="Center"  GotFocus="txtIP_GotFocus" TextChanged="TxtIPLength_TextChanged" PreviewKeyDown="txtIP_PreviewKeyDown" PreviewTextInput="TxtIPAddress_PreviewTextInput">
                            <Binding Path="VisionIP[0]" UpdateSourceTrigger="PropertyChanged">

                            </Binding>
                        </TextBox>
                        <materialDesign:PackIcon VerticalAlignment="Bottom" Width="20" Height="20" Kind="CircleSmall"/>
                        <TextBox x:Name="txtVisionIP2" Style="{DynamicResource IPInputMaterialDesignTextBox}" HorizontalAlignment="Center" GotFocus="txtIP_GotFocus" TextChanged="TxtIPLength_TextChanged" PreviewTextInput="TxtIPAddress_PreviewTextInput" PreviewKeyDown="txtIP_PreviewKeyDown">
                            <Binding Path="VisionIP[1]" UpdateSourceTrigger="PropertyChanged">

                            </Binding>
                        </TextBox>
                        <materialDesign:PackIcon VerticalAlignment="Bottom" Width="20" Height="20" Kind="CircleSmall"/>

                        <TextBox x:Name="txtVisionIP3"  Style="{DynamicResource IPInputMaterialDesignTextBox}" HorizontalAlignment="Center" GotFocus="txtIP_GotFocus" TextChanged="TxtIPLength_TextChanged" PreviewTextInput="TxtIPAddress_PreviewTextInput" PreviewKeyDown="txtIP_PreviewKeyDown"   >
                            <Binding Path="VisionIP[2]" UpdateSourceTrigger="PropertyChanged">

                            </Binding>
                        </TextBox>
                        <materialDesign:PackIcon VerticalAlignment="Bottom" Width="20" Height="20" Kind="CircleSmall"/>

                        <TextBox x:Name="txtVisionIP4"  Style="{DynamicResource IPInputMaterialDesignTextBox}" HorizontalAlignment="Center" GotFocus="txtIP_GotFocus" TextChanged="TxtIPLength_TextChanged" PreviewTextInput="TxtIPAddress_PreviewTextInput" PreviewKeyDown="txtIP_PreviewKeyDown"    >
                            <Binding Path="VisionIP[3]" UpdateSourceTrigger="PropertyChanged">

                            </Binding>
                        </TextBox>
                    </ui:SimpleStackPanel>
                    <TextBox  Grid.Row="1" Grid.Column="1"
                          Style="{DynamicResource InputMaterialDesignTextBox}"
                          Text="{Binding VisionPort}"
                          PreviewTextInput="TxtPort_PreviewTextInput"
                          HorizontalAlignment="Left"
                          
                           
                                       />
                    <ComboBox  Grid.Row="1" Grid.Column="2"  ItemsSource="{Binding TerminatorList}" DisplayMemberPath="Value"
                            SelectedValuePath="Description" SelectedItem="{Binding VisionTerminator}" SelectedValue="{Binding VisionTerminator}" 
                                          Style="{DynamicResource MaterialDesignFloatingHintComboBox}"
                                          Margin="30 0 0 0" 
                                          FontSize="15"
                                          HorizontalAlignment="Left"  
                                          Width="160"
                                          >
                    </ComboBox>

                </Grid>
                <!--Connection-->


                <Expander Grid.Row="8" FlowDirection="LeftToRight" Header="Advanced Settings" Margin="10" FontSize="17" Style="{DynamicResource MaterialDesignExpander}" >

                    <StackPanel Orientation="Vertical">
                        <StackPanel Orientation="Horizontal" >
                            <TextBox  x:Name="TxtLogFilePath" Style="{DynamicResource InputMaterialDesignTextBox}"   MinWidth="400" Text="{Binding LogFilePath}"
                                    materialDesign:HintAssist.Hint="Log File Path (User Log, Communication Log)" />
                            <Button Margin="10" Content="Browse" Command="{Binding ConnectServerCommand}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Grid.Row="9">
                            <ui:ToggleSwitch Margin="12" Header="Debug Log (Developer use)" />
                        </StackPanel>
                        <Button Width="100" Margin="5 10" Command="{Binding NavigateCommand}" Content="Navigate" />

                    </StackPanel>

                </Expander>


                <StackPanel Orientation="Horizontal" Grid.ColumnSpan="1" Grid.Row="10" HorizontalAlignment="Center">

                    <Button  Style="{DynamicResource MaterialDesignPaperButton}" Width="100" Margin="10" IsEnabled="{Binding CanExecute}" Command="{Binding SaveCommand}" HorizontalAlignment="Right" Content="Save All" />
                    <Button  Style="{DynamicResource MaterialDesignPaperSecondaryButton}"  Width="120" Margin="10" IsEnabled="{Binding CanExecute}" Command="{Binding }" Content="Create New"  />

                </StackPanel>

            </Grid>






        </materialDesign:Card>

    </ScrollViewer>

</UserControl>
